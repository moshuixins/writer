# 公文类型写作规范知识库
# 基于 GB/T 9704-2012 和《党政机关公文处理工作条例》

DOC_TYPE_GUIDES = {
    "通知": {
        "definition": "适用于发布、传达要求下级机关执行和有关单位周知或者执行的事项，批转、转发公文",
        "structure": [
            "标题：发文机关+事由+文种，如'XX市公安局交管支队关于XXX的通知'",
            "主送机关：所有需要执行或知晓的下级单位",
            "正文结构：缘由→事项→执行要求",
            "缘由段：说明发文背景和目的，常用'为了…根据…现将…通知如下'",
            "事项段：用'一、二、三'分条列述具体要求，每条一个主题",
            "结尾：常用'请遵照执行''请认真贯彻落实'等",
        ],
        "tone": "指令性强，语气明确果断，用'应当''必须''严禁'等",
        "common_errors": "避免事项之间逻辑混乱；避免要求过于笼统缺乏可操作性",
    },
    "报告": {
        "definition": "适用于向上级机关汇报工作、反映情况，回复上级机关的询问",
        "structure": [
            "标题：发文机关+事由+文种，如'关于XXX工作情况的报告'",
            "主送机关：直接上级机关",
            "正文结构：概述→主体→结尾",
            "概述段：简要说明报告的背景和目的",
            "主体段：分层次详细汇报，用数据和事实支撑",
            "结尾：常用'特此报告''以上报告，请审阅'",
        ],
        "tone": "客观陈述为主，实事求是，有数据支撑",
        "common_errors": "避免报告中夹带请示事项；避免只说成绩不提问题",
    },
    "请示": {
        "definition": "适用于向上级机关请求指示、批准",
        "structure": [
            "标题：发文机关+事由+文种，如'关于XXX的请示'",
            "主送机关：只能有一个直接上级机关",
            "正文结构：缘由→事项→请求",
            "缘由段：说明请示的原因和背景，要充分但简练",
            "事项段：明确提出请示的具体事项和方案",
            "结尾：必须用'妥否，请批示''当否，请批复'等请求语",
        ],
        "tone": "恭敬但不卑微，理由充分，请求明确",
        "common_errors": "一文一事，不要在一份请示中提多个不相关事项；不要多头请示",
    },
    "批复": {
        "definition": "适用于答复下级机关请示事项",
        "structure": [
            "标题：发文机关+事由+文种，如'关于XXX的批复'",
            "主送机关：请示的发文机关",
            "正文结构：引述→意见→要求",
            "引述段：引述来文，如'你单位《关于…的请示》(文号)收悉'",
            "意见段：明确表态同意、不同意或部分同意，说明理由",
            "结尾：常用'此复'",
        ],
        "tone": "态度明确，不含糊，有权威性",
        "common_errors": "避免态度模糊；必须针对请示事项逐一答复",
    },
    "函": {
        "definition": "适用于不相隶属机关之间商洽工作、询问和答复问题、请求批准和答复审批事项",
        "structure": [
            "标题：发文机关+事由+文种，如'关于商请XXX的函'",
            "主送机关：对方机关",
            "正文结构：缘由→事项→希望",
            "语气平等协商，不用指令性语言",
            "结尾：去函用'请予函复''盼复'，复函用'特此函复'",
        ],
        "tone": "平等协商，礼貌得体，不卑不亢",
        "common_errors": "避免对不相隶属机关使用指令性语气",
    },
    "纪要": {
        "definition": "适用于记载会议主要情况和议定事项",
        "structure": [
            "标题：会议名称+文种，如'XX会议纪要'",
            "正文结构：会议概况→议定事项→其他",
            "会议概况：时间、地点、主持人、参会人员、议题",
            "议定事项：逐条记录决定事项，明确责任单位和时限",
        ],
        "tone": "客观记录，准确概括，不加评论",
        "common_errors": "避免记录发言过程而非结论；议定事项要明确具体",
    },
    "方案": {
        "definition": "适用于对某项工作作出具体安排部署",
        "structure": [
            "标题：发文机关+事由+文种，如'关于XXX的实施方案'",
            "正文结构：目的意义→目标任务→实施步骤→保障措施",
            "目标要具体可量化，步骤要有时间节点",
            "明确责任分工和考核要求",
        ],
        "tone": "条理清晰，操作性强，目标明确",
        "common_errors": "避免目标空泛；步骤要有时间表和责任人",
    },
    "总结": {
        "definition": "适用于对一段时期的工作进行回顾、分析和评价",
        "structure": [
            "标题：时间范围+事由+文种，如'2024年度交通管理工作总结'",
            "正文结构：概述→主要工作及成效→存在问题→下步打算",
            "用数据说话，对比分析",
            "问题分析要客观，改进措施要具体",
        ],
        "tone": "实事求是，既肯定成绩也正视问题",
        "common_errors": "避免只报喜不报忧；数据要准确有出处",
    },
    "讲话稿": {
        "definition": "领导在会议或活动中的讲话、发言材料",
        "structure": [
            "开头：称谓+引入，如'同志们：'",
            "正文结构：形势分析→工作回顾→部署要求",
            "通常用'第一…第二…第三…'或'一要…二要…三要…'",
            "结尾：号召性语言，鼓舞士气",
        ],
        "tone": "口语化适度，有感染力，层次分明",
        "common_errors": "避免书面语过重；要有节奏感和感染力",
    },
}


def get_doc_type_guide(doc_type: str) -> str:
    """获取指定公文类型的写作指导"""
    guide = DOC_TYPE_GUIDES.get(doc_type)
    if not guide:
        return f"请按照{doc_type}的标准格式撰写。"

    lines = [f"【{doc_type}写作规范】"]
    lines.append(f"定义：{guide['definition']}")
    lines.append("结构要求：")
    for item in guide["structure"]:
        lines.append(f"  - {item}")
    lines.append(f"语气要求：{guide['tone']}")
    lines.append(f"常见问题：{guide['common_errors']}")
    return "\n".join(lines)
